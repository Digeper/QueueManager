# Kustomization for QueueManager
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: muzika

resources:
  - namespace.yaml
  - configmap.yaml
  - storageclass.yaml
  # storage-secret.yaml is created dynamically in CI/CD from GitHub Actions secrets
  # - storage-secret.yaml
  - persistentvolumeclaims.yaml
  - secretproviderclass.yaml
  - serviceaccount.yaml
  - deployment.yaml
  - service.yaml
  - secrets.yaml
  # Note: secrets.yaml is excluded from kustomize apply in CI/CD when using Key Vault
  # (managed by SecretProviderClass via init-secret-job)
  # storage-secret.yaml is created dynamically from AZURE_STORAGE_ACCOUNT_NAME and AZURE_STORAGE_ACCOUNT_KEY secrets

labels:
  - pairs:
      app.kubernetes.io/managed-by: kustomize
      app.kubernetes.io/part-of: muzika-platform

images:
  - name: ${ACR_NAME}.azurecr.io/muzika/queuemanager
    newTag: latest
